<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Sorry I'm Busy</title>

<style>
body{
  margin:0;
  background:black;
  overflow:hidden;
  font-family:Helvetica, Arial, sans-serif;
}

#scene{
  width:100vw;
  height:100vh;
  object-fit:cover;
  display:block;
}

#score{
  position:absolute;
  top:18px;
  left:18px;
  color:white;
  font-size:18px;
  opacity:0.85;
  user-select:none;
}
</style>
</head>

<body>

<div id="score">Score: 10</div>
<img id="scene" src="">

<script>
let score = 10;
let sceneIndex = 0;
let endingTriggered = false;

const sceneImg = document.getElementById("scene");
const scoreBox = document.getElementById("score");

function updateScore(){
  scoreBox.textContent = "Score: " + score;
}

function setImage(name){
  sceneImg.src = name;
}

// ---------- SCENES ----------
const scenes = [

  // Scene 0 — Email Before Leaving Work
  {
    img: "EmailBeforeLeavingWork.png",
    left: ()=>{ score -=1; next(); },   // 오늘 확인
    right: ()=>{ next(); }              // 내일 확인 (0)
  },

  // Scene 1 — Message on the Street
  {
    img: "MessageontheStreet.png",
    left: ()=>{ score -=1; next(); },   // 바로 답장
    right: ()=>{ score -=1; next(); }   // 미루기 (-1 점유)
  },

  // Scene 2 — Subway Entrance
  {
    img: "SubwayEntrance.png",
    left: ()=>{ goSubwayRoute(); },     // 왼쪽 = 지하철
    right: ()=>{ goBikeRoute(); }       // 오른쪽 = 자전거
  },

  // Scene 3A — On the Subway Seat
  {
    img: "OntheSubwaySeat.png",
    left: ()=>{ score -=1; goNearHome(); },   // 폰 확인
    right: ()=>{ goNearHome(); }              // 폰 안보기
  },

  // Scene 3B — Before Riding the Bike
  {
    img: "BeforeRidingtheBike.png",
    left: ()=>{ score +=1; next(); },  // 노래 듣기
    right: ()=>{ score +=2; next(); }  // 도심 소리 듣기
  },

  // Scene 4B — Riding the Bike, Nice View
  {
    img: "RidingtheBike,NiceView.png",
    left: ()=>{ score -=1; goNearHome(); },  // 사진 찍기
    right: ()=>{ score +=1; goNearHome(); }  // 그냥 지나가기
  },

  // Scene 5 — Junior Coworker
  {
    img: "JuniorCoworker.png",
    left: ()=>{ score -=2; next(); },  // “나 괜찮아…”
    right: ()=>{ next(); }             // “나 괜찮아!”
  },

  // Final Scene — In Front of Your Home
  {
    img: "InFrontofYourHome.png",
    left: ()=>{ score -=2; showEnding(); },  // 지금 확인
    right: ()=>{ score +=2; showEnding(); }  // 폰 잠그기
  }
];

// ---------- FLOW ----------
function next(){
  sceneIndex++;
  setImage(scenes[sceneIndex].img);
  updateScore();
}

// 지하철 루트
function goSubwayRoute(){
  sceneIndex = 3;
  setImage(scenes[sceneIndex].img);
  updateScore();
}

// 자전거 루트
function goBikeRoute(){
  sceneIndex = 4;
  setImage(scenes[sceneIndex].img);
  updateScore();
}

// Near Home 전환
function goNearHome(){
  setImage("NearHomeStreet.png");

  setTimeout(()=>{
    sceneIndex = 6;
    setImage(scenes[sceneIndex].img);
    updateScore();
  }, 1200);
}

// ---------- ENDING ----------
function showEnding(){
  if(endingTriggered) return;
  endingTriggered = true;

  setImage("LAST.png");

  setTimeout(()=>{
    let gender = Math.random() < 0.5 ? "male" : "female";
    let ending;

    if(score >=2 && score <=6){
      ending = "burned" + gender + ".png";
    }
    else if(score >=7 && score <=11){
      if(gender === "male"){
        ending = "burningmale.png";
      }else{
        ending = "burninfemale.png";
      }
    }
    else{
      ending = "fresh" + gender + ".png";
    }

    setImage(ending);
  },1000);
}

// ---------- TOUCH CONTROL ----------
document.addEventListener("click", (e)=>{
  if(endingTriggered) return;

  if(e.clientX < window.innerWidth/2){
    scenes[sceneIndex].left();
  }else{
    scenes[sceneIndex].right();
  }
});

// ---------- START ----------
setImage(scenes[0].img);
updateScore();
</script>

</body>
</html>
